/* 
Copyright Marcus Parsons 2017-2018
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
var atf_styles={};function atf(){var b=this;b.o={};var u=document.querySelector.bind(document),h=document.querySelectorAll.bind(document);function a(){var e,t,o=[];e=u("#"+b.o.container+"-atf-filterselect").value,t=b.o.caseSensitive?u("#"+b.o.container+"-atf-filtervalue").value:u("#"+b.o.container+"-atf-filtervalue").value.toLowerCase();for(var n=h("#"+b.o.table+" thead > tr > th"),i=0;i<n.length;i++){var a=n[i].innerHTML.trim();o.push(a)}var r=h("#"+b.o.container+"-atf-tbody > tr");if("All"===e)for(i=0;i<r.length;i++){var s=r[i].getElementsByTagName("td"),l=r[i];e:for(var c=0;c<s.length;c++){var d=b.o.caseSensitive?s[c].innerHTML:s[c].innerHTML.toLowerCase();if(-1<d.indexOf(t)){l.classList.remove("hider");break e}c===s.length-1&&l.classList.add("hider")}}else{var f=o.indexOf(e);for(i=0;i<r.length;i++)s=(l=r[i]).getElementsByTagName("td"),-1<(d=!0===b.o.caseSensitive?s[f].innerHTML:s[f].innerHTML.toLowerCase()).indexOf(t)?l.classList.remove("hider"):l.classList.add("hider")}}if(this.update=function(e,t){if(void 0!==t)if("object"==typeof t)switch(e){case"styles":var o,n=Object.keys(t);for(r=0;r<n.length;r++)o=n[r],u("#"+b.o.container).style.hasOwnProperty(o)&&(u("#"+b.o.container).style[o]=t[o])}else switch(b.o[e]=t,e){case"searchText":u("#"+b.o.container+"-atf-filtervalue").setAttribute("placeholder",b.o[e])}},this.removeColumn=function(e){if(e){var t=u("#"+b.o.container+'-atf-filterselect option[value="'+e+'"]');if(t)u("#"+b.o.container+"-atf-filterselect").removeChild(t)}},this.addPagingOpt=function(e){if(void 0!==e&&("string"==typeof e||"number"==typeof e)&&(e="string"==typeof e?+e:e,!isNaN(e))){for(var t=u("#"+b.o.container+"-atf-paging-select"),o=t.querySelectorAll("option"),n=[],i=/^[0-9]+$/,a=!1,r=0;r<o.length;r++)!0===i.test(o[r].innerHTML.trim())&&n.push(+o[r].innerHTML),"ALL"===o[r].innerHTML.toUpperCase()&&(a=!0);for(var s in n.push(e),n.sort(function(e,t){return t<e?1:e<t?-1:0}),a&&n.push("ALL"),t.innerHTML="",n)t.innerHTML+='<option value="'+n[s]+'">'+n[s]+"</option>";if(void 0!==b.o.defaultView){var l=u("#"+b.o.container+'-atf-paging-select option[value="'+b.o.defaultView+'"]');l&&l.setAttribute("selected","selected")}}},this.removePagingOpt=function(e){if(void 0!==e&&("string"==typeof e||"number"==typeof e)){var t=u("#"+b.o.container+'-atf-paging-select option[value="'+e+'"]');if(t&&t.remove(),void 0!==b.o.defaultView&&b.o.defaultView.toString()===e.toString()){var o=h("#"+b.o.container+"-atf-paging-select option");b.o.defaultView=o[0]}}},"object"==typeof arguments[0]&&Object.keys(arguments[0]).length){var e=arguments[0],t=["table","container","submitBy","display","includeLabel","labelText","isToggleableTable","searchText","styles","columnSelect","ignoreRows","caseSensitive","pagination","pagingViews","defaultView","onComplete"],o=Object.keys(e);if(o.indexOf("table")<0)return console.error("Error: no table listed in options given to auto-table-filter.  Please at least specify the table and a container to perform filtering with."),!1;if(o.indexOf("container")<0)return console.error('Error: no container listed in options given to auto-table-filter.  Please specify a container to perform filtering with by specifying its id i.e.\ncontainer: "myContainer".'),!1;for(var r=0;r<t.length;r++){var n=e[t[r]],i=t[r];if(void 0!==n)if(-1<["boolean","string","number","function"].indexOf(typeof n))b.o[i]=n;else if("object"==typeof n)if(n instanceof Array){b.o[i]=[];for(var s=0;s<n.length;s++)b.o[i].push(n[s])}else for(var l in b.o[i]={},n)b.o[i][l]=n[l]}if(!b.o.table)return console.error('Error: please make sure to specify an id for the table being filtered.  Use the same format as the id attribute in HTML i.e. a table with id="myFilteredTable" needs the table property set to "myFilteredTable".'),!1;if(u("#"+b.o.table+" > tbody").setAttribute("id",b.o.container+"-atf-tbody"),b.o.container){if(u("#"+b.o.container).classList.add("atf-filter-container"),void 0!==b.o.styles&&"object"==typeof b.o.styles){var c=Object.keys(b.o.styles);for(r=0;r<c.length;r++)u("#"+b.o.container).style.hasOwnProperty([c[r]])&&(u("#"+b.o.container).style[c[r]]=b.o.styles[c[r]])}u("#"+b.o.container).innerHTML=(void 0===b.o.includeLabel||!0===b.o.includeLabel?"<label for='atf-filtervalue'>"+(void 0!==b.o.labelText&&"string"==typeof b.o.labelText?b.o.labelText:"Search:")+"</label> &nbsp;":"")+"<input type='text' class='atf-filtervalue' id='"+b.o.container+"-atf-filtervalue' placeholder='"+(void 0===b.o.searchText||""===b.o.searchText?"Enter a value to search for":b.o.searchText)+"'>",void 0===b.o.columnSelect||!0===b.o.columnSelect?u("#"+b.o.container).innerHTML+="&nbsp; by column &nbsp; <select class='atf-filterselect' id='"+b.o.container+"-atf-filterselect'></select> &nbsp;":u("#"+b.o.container).innerHTML+="<select id='"+b.o.container+"-atf-filterselect' class='hider'></select> &nbsp;","button"===b.o.submitBy&&(u("#"+b.o.container).innerHTML+="<button class='atf-filtersubmit' id='"+b.o.container+"-atf-filtersubmit'>Submit</button>");var d=h("#"+b.o.table+" > thead > tr > th"),f="<option value='All' selected='selected'>All</option>";for(r=0;r<d.length;r++){var g=d[r].innerHTML.trim();""!==g&&(f+="<option value='"+g+"'>"+g+"</option>")}u("#"+b.o.container+"-atf-filterselect").innerHTML=f,u("#"+b.o.container).style.display=void 0!==b.o.display&&""!==b.o.display?b.o.display:"block","button"===b.o.submitBy&&u("#"+b.o.container+"-atf-filtersubmit").addEventListener("click",function(){a()},!1),u("#"+b.o.container+"-atf-filtervalue").addEventListener("keyup",function(e){if(13!==e.which||"button"!==b.o.submitBy&&b.o.submitBy||a(),8===e.which&&""===u("#"+b.o.container+"-atf-filtervalue").value){var t=h("#"+b.o.container+"-atf-tbody > tr");if(void 0===b.o.pagination)for(r=0;r<t.length;r++)t[r].classList.remove("hider");else{var o=u("#"+b.o.container+"-atf-paging-select").options[u("#"+b.o.container+"-atf-paging-select").selectedIndex].text;if("ALL"!==o){var n=+o,i=(+h(".atf-page-number-selected")[0].innerHTML-1)*n;if(void 0!==b.o.isToggleableTable)if(!0===b.o.isToggleableTable){for(r=0;r<2*n;r++)t[r].classList.remove("hider");for(r=t.length-1;2*n<=r;r--)t[r].classList.add("hider")}else{for(r=t.length-1;0<=r;r--)t[r].classList.add("hider");for(r=i;r<i+n;r++)r!==t.length&&t[r].classList.remove("hider")}else{for(r=t.length-1;0<=r;r--)t[r].classList.add("hider");for(r=i;r<i+n;r++)r!==t.length&&t[r].classList.remove("hider")}}else for(r=t.length-1;0<=r;r--)t[r].classList.remove("hider")}}"typing"===b.o.submitBy&&""!==u("#"+b.o.container+"-atf-filtervalue").value&&a()},!1)}if(void 0!==b.o.pagination){if(!0!==b.o.pagination)return console.error("Error: pagination is set to true, but no pagingViews array was given.  Please give an array of values that correspond to the number of items to show when selected."),!1;var p=document.createElement("div");if(p.id=b.o.container+"-atf-paging-container",p.setAttribute("class","atf-paging-container"),u("#"+b.o.container).insertAdjacentElement("afterend",p),void 0!==b.o.pagingViews){if(b.o.pagingViews.length<1)return console.error("Error: pagination is set to true, but the pagingViews array was empty.  Please give an array of number values that correspond to the number of items to show when selected (and/or an optional 'ALL' view)."),!1;var v=document.createElement("label");v.innerHTML="Show Records: &nbsp;&nbsp;&nbsp;",v.id=b.o.container+"-atf-paging-label",v.setAttribute("for","atf-paging-select"),u("#"+b.o.container+"-atf-paging-container").insertAdjacentElement("beforeend",v);var m,y=document.createElement("select");y.id=b.o.container+"-atf-paging-select",y.setAttribute("class","atf-paging-select"),u("#"+b.o.container+"-atf-paging-label").insertAdjacentElement("afterend",y);for(var L=0;L<b.o.pagingViews.length;L++){var w=document.createElement("option");w.innerHTML=b.o.pagingViews[L],w.value=b.o.pagingViews[L],u("#"+b.o.container+"-atf-paging-select").insertAdjacentElement("beforeend",w)}void 0!==b.o.defaultView&&("string"==typeof b.o.defaultView&&"ALL"!==b.o.defaultView&&(b.o.defaultView=+b.o.defaultView),"ALL"===b.o.defaultView?(m=u("#"+b.o.container+'-atf-paging-select option[value="ALL"]'))&&m.setAttribute("selected","selected"):(b.o.pagingViews.indexOf(b.o.defaultView)<0&&(b.o.defaultView=b.o.pagingViews[0]),(m=u("#"+b.o.container+'-atf-paging-select option[value="'+b.o.defaultView+'"]'))&&m.setAttribute("selected","selected")));var T=u("#"+b.o.container+"-atf-paging-select").options[u("#"+b.o.container+"-atf-paging-select").selectedIndex].text,E=+T,A=h("#"+b.o.container+"-atf-tbody > tr");e:for(var k=0;k<A.length;k++){if(void 0!==b.o.ignoreRows&&"object"==typeof b.o.ignoreRows)for(var M=A[k].classList,H=0;H<b.o.ignoreRows.length;H++)if(M.contains(b.o.ignoreRows[H]))continue e;if("ALL"===T)break;void 0!==b.o.isToggleableTable&&!0===b.o.isToggleableTable?(2*E<=k&&A[k].classList.add("hider"),k++):E<=k&&A[k].classList.add("hider")}var V=(A=h("#"+b.o.container+"-atf-tbody > tr:not(.is-hidden)")).length,O=Math.ceil(V/E),S=document.createElement("div");S.style.display="inline-block",S.classList.add("atf-paging-number-container"),S.id=b.o.container+"-atf-paging-number-container",p.insertAdjacentElement("beforeend",S);for(var x=0;x<O;x++){var j=document.createElement("span");j.classList.add("atf-page-number"),0===x&&j.classList.add("atf-page-number-selected"),j.innerHTML=(x+1).toString(),S.insertAdjacentElement("beforeend",j)}var C=h(".atf-page-number");for(x=0;x<C.length;x++)C[x].addEventListener("click",function(){for(var e=0;e<C.length;e++)C[e].classList.remove("atf-page-number-selected");this.classList.add("atf-page-number-selected");for(var t=+this.innerHTML,o=(t-1)*E,n=t*E-1,i=(A=h("#"+b.o.container+"-atf-tbody > tr:not(.is-hidden)")).length-1;0<=i;i--)o-1<i&&i<n+1?A[i].classList.remove("hider"):A[i].classList.add("hider")});u("#"+b.o.container+"-atf-paging-select").addEventListener("change",function(){for(var e=this.options[this.selectedIndex].text,a=parseInt(e,10),r=h("#"+b.o.container+"-atf-tbody > tr"),t=0;t<r.length;t++)r[t].classList.remove("hider");e:for(t=0;t<r.length;t++){if(void 0!==b.o.ignoreRows&&"object"==typeof b.o.ignoreRows)for(var o=r[t].classList,n=0;n<b.o.ignoreRows.length;n++)if(o.contains(b.o.ignoreRows[n]))continue e;if("ALL"===e)break;void 0!==b.o.isToggleableTable&&!0===b.o.isToggleableTable?(2*a<=t&&r[t].classList.add("hider"),t++):a<=t&&r[t].classList.add("hider")}var i=u("#"+b.o.container+"-atf-paging-number-container");i.parentNode.removeChild(i);var s=(r=h("#"+b.o.container+"-atf-tbody > tr:not(.is-hidden)")).length,l=Math.ceil(s/a),c=document.createElement("div");c.style.display="inline-block",c.classList.add("atf-paging-number-container"),c.id=b.o.container+"-atf-paging-number-container",p.insertAdjacentElement("beforeend",c);for(var d=0;d<l;d++){var f=document.createElement("span");f.classList.add("atf-page-number"),0===d&&f.classList.add("atf-page-number-selected"),f.innerHTML=(d+1).toString(),c.insertAdjacentElement("beforeend",f)}var g=h(".atf-page-number");for(d=0;d<g.length;d++)g[d].addEventListener("click",function(){for(var e=0;e<g.length;e++)g[e].classList.remove("atf-page-number-selected");this.classList.add("atf-page-number-selected");for(var t=parseInt(this.innerHTML,10),o=(t-1)*a,n=t*a-1,i=(r=h("#"+b.o.container+"-atf-tbody > tr:not(.is-hidden)")).length-1;0<=i;i--)o-1<i&&i<n+1?r[i].classList.remove("hider"):r[i].classList.add("hider")})})}}}else if("object"!=typeof arguments[0]||void 0===arguments[0])console.error('Error: make sure to pass in a set of {} surrounding your properties like so:\natf({\n  table: "myTable",\n  container: "myContainer",\n  submitBy: "typing"\n});');else if(Object.keys(arguments[0]).length<1)return console.error('Error: no properties listed in the options object given to auto-table-filter.  Please at least specify the table, a container, and submitBy for filtering elements to perform filtering with. Remember to set these to the id values for the elements the same as the HTML id attribute i.e. a table with the id of "myFilteredTable" needs to have "myFilteredTable" passed to auto-table-filter as the table id and same with any other element based options.'),!1;"function"==typeof b.o.onComplete&&b.o.onComplete()}atf_styles.COOLBLUE={background:"#357ebd",color:"white"},atf_styles.BLUESKIES={background:"linear-gradient(to right, #56ccf2, #2f80ed)",color:"white"},atf_styles.CLEARBLACK={background:"none",color:"black"},atf_styles.CLEARWHITE={background:"none",color:"white"},atf_styles.DEEPSEASPACE={background:"linear-gradient(to right, #2c3e50, #4ca1af)",color:"white"},atf_styles.HYDROGEN={background:"linear-gradient(to right, #667db6, #0082c8, #0082c8, #667db6)",color:"white"},atf_styles.LAWRENCIUM={background:"linear-gradient(to right, #0f0c29, #302b63, #24243e)",color:"white"},atf_styles.MILD={background:"linear-gradient(to right, #67b26f, #4ca2cd)",color:"white"},atf_styles.MOONPURPLE={background:"linear-gradient(to right, #4e54c8, #8f94fb)",color:"white"},atf_styles.MOSS={background:"linear-gradient(to right, #134e5e, #71b280)",color:"white"},atf_styles.ONYX={background:"linear-gradient(to bottom, #414345, #232526)",color:"white"},atf_styles.RAINBOWBLUE={background:"linear-gradient(to right, #00f260, #0575e6)",color:"white"},atf_styles.STRIPE={background:"linear-gradient(to right, #1fa2ff, #12d8fa, #a6ffcb)",color:"white"},atf_styles.VENICE={background:"linear-gradient(to right, #6190e8, #a7bfe8)",color:"white"};
